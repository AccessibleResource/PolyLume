<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>PolyLume by Accessible Resource</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --font-family: 'Poppins', sans-serif;
  --border-radius: 16px;
  --transition-speed: 0.3s;
  
  /* Tool 1: Process Colors */
  --process-bg: linear-gradient(135deg, #5b24ff 0%, #a18aff 100%);
  --process-btn-correct-bg: #4d94ff;
  --process-btn-rewrite-bg: #ff4d94;
  --process-shadow: rgba(91, 36, 255, 0.2);

  /* Tool 2: Output Colors */
  --output-bg: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
  --output-btn-play-bg: #ffffff;
  --output-btn-play-text: #11998e;
  --output-shadow: rgba(17, 153, 142, 0.2);

  /* Tool 3: Translate Colors */
  --translate-bg: linear-gradient(135deg, #ff8c42 0%, #ffb88c 100%);
  --translate-btn-bg: #ffffff;
  --translate-btn-text: #ff8c42;
  --translate-shadow: rgba(255, 140, 66, 0.25);
}

* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

body { 
  font-family: var(--font-family);
  background: #f0f2f5;
  color: #333;
  line-height: 1.6;
  overflow-x: hidden;
}

header { 
  text-align: center; 
  padding: 50px 20px 40px; 
  background: #ffffff;
}

header h1 { 
  font-size: 3rem; 
  font-weight: 700; 
  color: #2c3e50;
  margin-bottom: 10px;
}

header p { 
  margin: 5px 0; 
  font-size: 1.1rem; 
  color: #555; 
  max-width: 600px;
  margin-left: auto;
  margin-right: auto;
}

.container { 
  display: flex; 
  flex-wrap: wrap; 
  justify-content: center; 
  gap: 25px; 
  padding: 25px; 
}

.panel { 
  flex: 1; 
  min-width: 340px; 
  max-width: 600px; 
  background: rgba(255, 255, 255, 0.5);
  border-radius: var(--border-radius); 
  padding: 25px; 
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all var(--transition-speed) ease;
}

.panel:hover {
  transform: translateY(-5px);
  box-shadow: 0 15px 35px rgba(0, 0, 0, 0.12);
}

.panel h2 {
  font-weight: 600;
  color: #fff;
  margin-bottom: 15px;
  padding: 10px 15px;
  border-radius: 10px;
  display: inline-block;
  font-size: 1.25rem;
  text-shadow: 0 1px 3px rgba(0,0,0,0.1);
}

/* --- Theme 1: Process Panel --- */
.panel.process { border-top: 4px solid #a18aff; }
.panel.process h2 { background: var(--process-bg); box-shadow: 0 4px 15px var(--process-shadow); }
.panel.process .btn-correct { background-color: var(--process-btn-correct-bg); }
.panel.process .btn-rewrite { background-color: var(--process-btn-rewrite-bg); }
.panel.process textarea:focus { box-shadow: inset 0 2px 4px rgba(0,0,0,0.06), 0 0 0 3px var(--process-shadow); }


/* --- Theme 2: Output Panel --- */
.panel.output { border-top: 4px solid #38ef7d; }
.panel.output h2 { background: var(--output-bg); box-shadow: 0 4px 15px var(--output-shadow); }
.panel.output button { background-color: var(--output-btn-play-bg); color: var(--output-btn-play-text); }
.panel.output textarea:focus { box-shadow: inset 0 2px 4px rgba(0,0,0,0.06), 0 0 0 3px var(--output-shadow); }


/* --- Theme 3: Translate Panel --- */
.panel.translate { border-top: 4px solid #ffb88c; }
.panel.translate h2 { background: var(--translate-bg); box-shadow: 0 4px 15px var(--translate-shadow); }
.panel.translate button { background-color: var(--translate-btn-bg); color: var(--translate-btn-text); }
.panel.translate select:focus { box-shadow: 0 0 0 3px var(--translate-shadow); }


textarea, select {
  width: 100%;
  border: 1px solid #dfe6e9;
  border-radius: 12px; 
  padding: 15px; 
  font-size: 1rem; 
  outline: none; 
  box-shadow: inset 0 2px 4px rgba(0,0,0,0.06);
  font-family: var(--font-family);
  transition: box-shadow var(--transition-speed) ease;
  background: rgba(255,255,255,0.8);
}

textarea {
  height: 200px;
  resize: vertical;
}

select {
  cursor: pointer;
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%23555' viewBox='0 0 16 16'%3E%3Cpath fill-rule='evenodd' d='M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 15px center;
  background-size: 16px;
}

.buttons { 
  display: flex; 
  flex-wrap: wrap; 
  gap: 12px; 
  margin-top: 15px; 
}

button { 
  flex: 1; 
  padding: 12px 15px; 
  font-size: 1rem; 
  border: none; 
  border-radius: 12px; 
  cursor: pointer; 
  transition: all var(--transition-speed) ease;
  font-weight: 600; 
  color: #fff;
  box-shadow: 0 4px 15px rgba(0,0,0,0.1);
  min-width: 120px;
}

button:hover { 
  transform: translateY(-3px); 
  box-shadow: 0 6px 20px rgba(0,0,0,0.15);
  filter: brightness(1.1);
}

button:active {
  transform: translateY(-1px);
  box-shadow: 0 3px 10px rgba(0,0,0,0.15);
}

.status { 
  margin-top: 15px;
  font-size: 0.9rem;
  color: #555;
  font-style: italic; 
  min-height: 1.2em;
}

.stats { 
  margin-top: 15px;
  font-size: 0.95rem;
  line-height: 1.8;
  color: #333; 
  background: #f0f2f5;
  padding: 15px;
  border-radius: 12px;
}

@media(max-width: 768px){ 
  header h1 { font-size: 2.2rem; }
  header p { font-size: 1rem; }
  .container{ flex-direction: column; padding: 15px; gap: 20px; } 
  .panel { min-width: 100%; }
}
</style>
</head>
<body>
<header>
  <h1>PolyLume</h1>
  <p>Enhance, correct, and translate your text with AI-assisted tools in any language.</p>
  <p>Developed by Accessible Resource</p>
</header>

<div class="container">
  <div class="panel process">
    <h2>Do you want to process this text?</h2>
    <textarea id="inputText" placeholder="Type or paste your text here..."></textarea>
    <div class="buttons">
      <button class="btn-correct" onclick="processText('correct')">In Hands</button>
      <button class="btn-rewrite" onclick="processText('rewrite')">Rewrite</button>
    </div>
    <div class="status" id="status">Ready to process...</div>
  </div>

  <div class="panel output">
    <h2>Output</h2>
    <textarea id="outputText" readonly placeholder="Your processed text will appear here..."></textarea>
    <div class="buttons">
      <button onclick="playAudio()">Play Audio</button>
    </div>
    <div class="stats" id="stats">
      Characters: 0<br>
      Words: 0<br>
      Paragraphs: 0<br>
      Special Characters: 0<br>
      Sentences: 0
    </div>
  </div>
</div>

<div class="container">
  <div class="panel translate">
    <h2>Do you want to translate this text?</h2>
    <select id="languageSelect">
      <option value="bn">Bengali</option>
      <option value="en">English</option>
      <option value="hi">Hindi</option>
      <option value="fr">French</option>
      <option value="es">Spanish</option>
      <option value="ar">Arabic</option>
      <option value="ru">Russian</option>
      <option value="zh">Chinese</option>
      <option value="ja">Japanese</option>
      <option value="de">German</option>
    </select>
    <div class="buttons">
      <button onclick="translateText()">Translate</button>
    </div>
  </div>
</div>

<script>
// WARNING: It is strongly recommended to use a backend server to store and use the API key
// to prevent it from being exposed on the client-side.
const GEMINI_API_KEY = "AIzaSyAxSh3fw8eBCeLNHnfCp2BpdsXc2c8ZJSA"; // Please use your own API key.

function updateStats(text){
  const stats = {
    characters:text.length,
    words:text.trim()?text.trim().split(/\s+/).length:0,
    paragraphs:text.trim()?text.trim().split(/\n+/).length:0,
    special:text.replace(/[a-zA-Z0-9\s]/g,"").length,
    sentences:text.split(/[.!?]+/).filter(Boolean).length
  };
  document.getElementById("stats").innerHTML=
  `Characters: ${stats.characters}<br>
   Words: ${stats.words}<br>
   Paragraphs: ${stats.paragraphs}<br>
   Special Characters: ${stats.special}<br>
   Sentences: ${stats.sentences}`;
}

async function callGeminiAPI(prompt){
  const status = document.getElementById("status");
  try {
    const response = await fetch("https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent",{
      method:"POST",
      headers:{
        "Content-Type":"application/json",
        "X-goog-api-key": GEMINI_API_KEY
      },
      body: JSON.stringify({contents:[{parts:[{text:prompt}]}]})
    });
    
    if (!response.ok) {
        const errorData = await response.json();
        throw new Error(errorData.error.message || `HTTP error! status: ${response.status}`);
    }
    
    const data = await response.json();
    console.log("Gemini Response:", data);

    if (data.candidates && data.candidates[0] && data.candidates[0].content && data.candidates[0].content.parts && data.candidates[0].content.parts[0]) {
      return data.candidates[0].content.parts[0].text.trim();
    }
    
    // Handle cases where the API might block the request (e.g., safety settings)
    if (data.candidates && data.candidates[0] && data.candidates[0].finishReason !== "STOP") {
        throw new Error(`API call finished with reason: ${data.candidates[0].finishReason}. The response might be blocked.`);
    }

    throw new Error("Unexpected Gemini API response structure.");

  } catch(err) {
    console.error("API Call Error:", err);
    status.textContent = "Error: " + err.message;
    throw err; // Re-throw error to be caught by the calling function
  }
}

async function processText(mode){
  const input = document.getElementById("inputText").value.trim();
  const status = document.getElementById("status");
  if(!input){ alert("Please enter some text first!"); return; }

  let prompt="";
  if(mode==="correct"){ 
    status.textContent="Correcting text…"; 
    prompt = `Correct the grammar and spelling mistakes in the following text. Provide only the corrected text and nothing else.\n\nText:\n"${input}"`;
  } else { 
    status.textContent="Rewriting text…";
    prompt = `Rewrite the following text to improve its clarity and flow. Provide only the rewritten text as the output, with no additional commentary.\n\nText to rewrite:\n"${input}"`;
  }

  try {
    const result = await callGeminiAPI(prompt);
    document.getElementById("outputText").value = result;
    updateStats(result);
    status.textContent="Completed successfully!";
  } catch(err) { 
    status.textContent="Error: " + err.message; 
    // Clear output on error
    document.getElementById("outputText").value = "";
    updateStats("");
  }
}

async function translateText(){
  // Use output text if available, otherwise use input text for translation
  const text = document.getElementById("outputText").value.trim() || document.getElementById("inputText").value.trim();
  const langSelect = document.getElementById("languageSelect");
  const lang = langSelect.value;
  const langName = langSelect.options[langSelect.selectedIndex].text;
  const status = document.getElementById("status");
  
  if(!text){ alert("No text available to translate!"); return; }

  status.textContent=`Translating to ${langName}…`;
  const prompt = `Translate the following text into ${langName}. Your response must contain only the translated text, without any additional phrases or explanations.\n\nText to translate:\n"${text}"`;

  try {
    const result = await callGeminiAPI(prompt);
    document.getElementById("outputText").value = result;
    updateStats(result);
    status.textContent="Translation complete!";
  } catch(err) { 
    status.textContent="Error: " + err.message; 
    // Clear output on error
    document.getElementById("outputText").value = "";
    updateStats("");
  }
}

function playAudio(){
  const text = document.getElementById("outputText").value;
  if(!text){ alert("No text to read aloud!"); return; }
  // Cancel any ongoing speech before starting a new one
  speechSynthesis.cancel();
  const utterance = new SpeechSynthesisUtterance(text);
  speechSynthesis.speak(utterance);
}
</script>
</body>
</html>